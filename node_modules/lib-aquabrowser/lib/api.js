var _ = require('underscore');
var req = require('request');

var config = require('../../../config');

/**
 * Initializes the Aquabrowser API
 *
 * @param  {Function}   callback            Standard callback function
 */
var init = function() {};

/**
 * Get the results from the AquaBrowser API
 * @see http://www.lib.cam.ac.uk/api/docs/ab_sru.htm
 *
 * @param  {String}    query                The query that will be processed to AquaBrowser
 */
var getAquabrowserResults = module.exports.getAquabrowserResults = function(query, callback) {

    var url = 'http://search.lib.cam.ac.uk/sru.ashx?operation=searchRetrieve&version=1.1&query=' + query + '&maximumRecords=10&recordSchema=dc';

    // Create an options object that can be submitted to the Aquabrowser API
    var options = {
        //'url': config.constants.engines.aquabrowser.uri
        'url': url
    };

    req(options, function(err, res, body) {
        if (err) {
            console.log(err);
        }

        if (res) {
            console.log(res.body);
        }
    });

    var err = null;
    var res = {};
    res.body = {};
    callback(err, res);
};

init();
